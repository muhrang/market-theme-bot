name: Run Bot

on:
  workflow_dispatch:
  schedule:
    - cron: "0/20 0-6 * * 1-5"   # í‰ì¼ ì˜¤ì „ì¥ ë™ì•ˆ 20ë¶„ ê°„ê²© ì‹¤í–‰ (ì›í•˜ë©´ ìˆ˜ì • ê°€ëŠ¥)
    # ì˜ˆ: "*/5 * * * *" â†’ 5ë¶„ë§ˆë‹¤ ì‹¤í–‰

jobs:
  run-bot:
    runs-on: ubuntu-latest

    steps:
    - name: âœ… ë¦¬í¬ì§€í† ë¦¬ Checkout
      uses: actions/checkout@v3

    - name: âœ… Python ì„¤ì¹˜
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'

    - name: âœ… ì˜ì¡´ì„± ì„¤ì¹˜
      run: |
        pip install --upgrade pip
        pip install playwright nest_asyncio easyocr python-Levenshtein jamo requests beautifulsoup4 openai pytesseract pandas numpy opencv-python-headless FinanceDataReader

    - name: âœ… Playwright ë¸Œë¼ìš°ì € ì„¤ì¹˜
      run: |
        playwright install chromium

    - name: âœ… OPENAI / Telegram í‚¤ ì£¼ì…
      env:
        OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}
        TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
        TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
      run: |
        echo "í™˜ê²½ë³€ìˆ˜ ì„¤ì • ì™„ë£Œ"

    - name: ğŸš€ ì‹¤í–‰
      env:
        OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}
        TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
        TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
      run: |
        python run.py
